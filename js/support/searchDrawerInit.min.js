jQuery(document).ready(function(a){function b(a){var b=a.parent().hasClass("lone-parent"),c=a.hasClass("parent-category"),d=a.parents(".drawer-dropdown"),e=d.hasClass("active"),f=a.parent().siblings(),g=f.hasClass("active");c||(b&&console.log("no parent"),e||g||d.addClass("active"),e&&!g&&d.removeClass("active"),console.log(d))}a(".issue-row").flickity({cellSelector:".carousel-cell",cellAlign:"left",pageDots:!1,contain:!0,setGallerySize:!1,dragThreshold:10}),a(".drawer").drawer({class:{nav:"drawer-nav",toggle:"drawer-toggle",overlay:"drawer-overlay",open:"drawer-open",close:"drawer-close",dropdown:"dropdown-toggle"},iscroll:{mouseWheel:!0,preventDefault:!1},showOverlay:!0}),a("#filterToggle").click(function(b){a(".search-results").toggleClass("opened")});var c=new Uri(location),d=c.getQueryParamValue("cat"),e=c.getQueryParamValue("issue");if(void 0!==d){var f=d.split(",");f.forEach(function(c){a(".search-container").find("[data-cat_id="+c+"]").addClass("active"),a(".category-menu").find("[data-cat_id="+c+"]").parent().addClass("active"),b(a(".category-menu").find("[data-cat_id="+c+"]"))})}if(void 0!==e){var f=e.split(",");f.forEach(function(c){a(".search-container").find("[data-issue="+c+"]").toggleClass("active"),a(".issue-menu").find("[data-issue="+c+"]").parent().addClass("active"),b(a(".issue-menu").find("[data-issue="+c+"]"))})}a(".current-filter-wrapper>.filter-item").click(function(c){console.log(a(this).data("cat_id"));var d=a(".drawer-menu").find("[data-cat_id="+a(this).data("cat_id")+"]");d.parent().removeClass("active"),a(this).removeClass("active"),b(d)}),a(".drawer-menu .filter-item").click(function(c){c.stopPropagation(),a(this).parent().toggleClass("active"),b(a(this)),a(".search-container").find("[data-cat_id="+a(this).data("cat_id")+"]").not(a(this)).toggleClass("active"),a(".search-container").find("[data-issue="+a(this).data("issue")+"]").not(a(this)).toggleClass("active")}),a(".columns-search-input-submit").click(function(b){var d=[],e=[];a(".category-menu .cat-item").filter(".active").each(function(){d.push(a(this).children(".filter-item").data("cat_id"))}),a(".issue-menu .issue-filter").parent().filter(".active").not(".parent-category").each(function(){e.push(a(this).children(".issue-filter").data("issue"))});var f=a(".columns-search-input-field").val(),g=c.clone().setPath("/search").deleteQueryParam("cat").deleteQueryParam("issue");d.length>0&&g.replaceQueryParam("cat",d.join(",")),e.length>0&&g.replaceQueryParam("issue",e.join(",")),f&&g.replaceQueryParam("search",f),location.replace(g.toString())}),a(".search-filter-item.active").click(function(b){a(".columns-search-input-field").val(""),c.replaceQueryParam("search","")}),a(".columns-search-input-field").on("keyup",_.debounce(function(b){switch(console.log("updating search"),b.currentTarget.value){case"":a(".search-filter-item").html(b.currentTarget.value).removeClass("active");break;default:a(".columns-search-input-field").not(a(this).each(function(){a(".columns-search-input-field").val(b.currentTarget.value),a(".search-filter-item").html(b.currentTarget.value).addClass("active")}))}},500))});